<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 7bab28d0387413d6fe6b8475e3b8ac31592c1c7c
=======
>>>>>>> e5aabc5ca36e17037a3e6f9e39730bc28eaabb59
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<<<<<<< HEAD
<<<<<<< HEAD
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanité numérique 2021-2022</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /*pour les initiales en majuscule*/
        .card-title:first-letter {
            text-transform: uppercase;
        }

        .title {
            font-size: 40px;
            display: initial;
        }

        img {
            width: 100%;
            height: 100%;
            max-width: 200px;
            max-height: 200px;
        }

        .container {
            display: flex;
        }
    </style>
</head>

<body>
    <title class="title">Humanité numérique 2021 - 2022</title>


    <div class="container">
        <div class="row" id="etuGraph">
            
        </div>
        <svg width="600" height="500"></svg>
    </div>

    <script>

        //
        var dataPhoto, dataForm, dataFacet = [], dataDoublons = {}
            , vals = {
                "Pas besoin": 1, "Besoin d'approfondissement": 5, "Besoin urgent": 10, "je ne connais pas du tout": 1, "je connais un peu": 5, "je vonnais bien": 10, "je suis expert(e)": 20
                , "Oui": 1, "Non": 1
                , "jamais": 1, "rarement": 2, "souvent": 5, "je suis accro": 10
                , "Dans quel parcours êtes vous inscris ?": "Parcours"
                , "Avez-vous un ordinateur personnel pour suivre les cours ?": "Ordinateur"
                , "Votre connexion internet personnelle est :": "Connexion"
                , "Votre compte GitHub": "Compte"
                , "Votre compte Diigo": "Compte"
                , "Votre compte Zotero": "Compte"
                , "Vos spécialités": "Spécialités"
                , "Vos spécialités": "Objectifs"
                , "Votre formation précédente": "Formation"
                , "Quelles sont besoins ?": "Besoins"
                , "Quelles sont vos compétences ?": "Compétences"
                , "Quelles outils utilisez vous ?": "Outils"
                , "Langages": "Langages"
                , "Langues": "Langues"
                , "CMS": "CMS"
                , "Quels réseaux sociaux": "Réseaux sociaux"
            }
            , selectEtu;


        //récupération des données des formulaires google
        //"FormulaireGEN19.csv";//
        let url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTM42Rbon532i3N3aW25ZpkoKtsMN-u6C7ycSj6A3DP2QCO89n3OMkseL--aI9a9s3ouwQJsVk6cOFw/pub?gid=513110937&single=true&output=csv';
        //let url = 'data.csv';            
        var q = d3.queue()
            .defer(d3.csv, url)
            .awaitAll(function (error, results) {
                if (error) throw error;
                setData(results);
            });

        var divTT = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        function setData(data) {

            dataForm = data[0];
            let dataEtu = [];

            dataForm.forEach(function (d, j) {
                d.reponses = { 'besoins': [], 'competences': [], 'outils': [] };
                for (let i in d) {

                    let quest = i.indexOf("[") > 0 ? vals[i.substring(0, i.indexOf("[") - 1)] : vals[i];
                    let prop = i.substring(i.indexOf("[") + 1, i.indexOf("]"));
                    let v = d[i];
                    let n = vals[v];
                    if (quest) {
                        if (dataDoublons[quest] === undefined) {
                            dataDoublons[quest] = dataFacet.length;
                            dataFacet.push({ 'label': quest, 'values': [] });
                        }
                        let rep = prop ? prop : v;
                        let kRep = quest + '_' + rep;
                        if (dataDoublons[kRep] === undefined) {
                            dataDoublons[kRep] = dataFacet[dataDoublons[quest]]['values'].length;
                            dataFacet[dataDoublons[quest]]['values'].push({
                                'prop': rep
                                , 'importance': 0
                                , 'expression': v
                                , 'ids': []
                            });
                        }
                        dataFacet[dataDoublons[quest]]['values'][dataDoublons[kRep]]['ids'].push(j);
                        dataFacet[dataDoublons[quest]]['values'][dataDoublons[kRep]]['importance'] += n ? n : 1;

                    }
                    if (i.indexOf("besoins") > 0) {
                        d.reponses.besoins.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                    if (i.indexOf("compétences") > 0) {
                        d.reponses.competences.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                    if (i.indexOf("outils utilisez") > 0) {
                        d.reponses.outils.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                }
            });


            var cards = d3.select('#etuGraph').selectAll(".col-sm-4 mb-12").data(dataForm).enter()
                .append('div').attr('class', 'col-sm-4 mb-12').style('margin-bottom', '10px')
                .append("div").attr('class', 'card');
            cards.append("img")
                .attr('id', function (d, i) { return 'imgCard' + i })
                .attr('class', 'card-img-top')
                .attr('src', function (d) {
                    let url = new URL(d['Votre photo']);
                    let urlParam = new URLSearchParams(url.search);
                    let id = urlParam.get('id');
                    let urlTof = "https://drive.google.com/uc?id=" + id + "&export=download";
                    return urlTof;
                });


    
            var cardBody = cards.append('div').attr('class', 'card-body');
            cardBody.append('h4').attr('class', 'card-title')
                .text(function (d) {
                    return d['Votre prénom'].toLowerCase();
                });
            cardBody.append('h5').attr('class', 'card-title')
                .text(function (d) {
                    return d['Votre nom'].toLowerCase();
                });
            cardBody.append('h6').text(d => d['Dans quel parcours êtes vous inscris ?']);


            html = '<div class="container"><div class="row">';
            html += '<div id="etudNum__Col1" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '<div id="etudNum__Col2" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '<div id="etudNum__Col3" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '</div></div>';
            cardBody.append('div').attr('class', 'card-text').attr('id', function (d, i) { return 'etudNum_' + i; })
                .html(function (d, i) { return html.replace(/__/gi, "_" + i + "_"); });
            cards.append('div').attr('class', 'card-footer')
                .append('small').attr('class', 'text-muted')
                .text(function (d, i) {

                    var size = 200;
                    drawGraphResponse("#etudNum_" + i + "_Col1", 'Besoins', d.reponses.besoins, size);
                    drawGraphResponse("#etudNum_" + i + "_Col2", 'Compétences', d.reponses.competences, size);
                    drawGraphResponse("#etudNum_" + i + "_Col3", 'Outils', d.reponses.outils, size);
                    return d['Votre mail'].toLowerCase();
                });

        }

        function drawGraphResponse(idE, titre, data, size) {

            let etuGraph = etuChart()
                .width(size)
                .height(size)
                .cornerRadius(0)
                .padAngle(0)
                .variable('importance')
                .category('prop')
                .title(titre);
            let s = d3.select(idE)
                .datum(data)
                .call(etuGraph);
            console.log(idE + " graph fait");
        }

        function etuChart() {
            var width,
                height,
                margin = { top: 0, right: 0, bottom: 10, left: 0 },
                colour = d3.scaleOrdinal(d3.schemeCategory20c),
                variable,
                category,
                padAngle,
                floatFormat = d3.format('.4r'),
                cornerRadius,
                percentFormat = d3.format(',.2%'),
                title;

            function chart(selection) {
                selection.each(function (data) {


                    // var radius = Math.min(width, height) / 2;

                    // // var pie = d3.pie().value(function (d) {
                    // //     return floatFormat(d[variable]);
                    // // })
                    // //     .sort(null);

                    // var pie = d3.pie();

                    // var arc = d3.arc()
                    //     .innerRadius(0)
                    //     .outerRadius(radius);

                    // var arcs = g.selectAll("arc")
                    //     .data(pie(data))
                    //     .enter()
                    //     .append("g")
                    //     .attr("class", "arc")

                    // var arc = d3.arc()
                    //     .outerRadius(radius)
                    //     .innerRadius(radius)
                    //     .cornerRadius(cornerRadius)
                    //     .padAngle(padAngle);

                    // this arc is used for aligning the text labels
                    // var outerArc = d3.arc()
                    //     .outerRadius(radius)
                    //     .innerRadius(radius);

                    var radius = Math.min(width, height) / 2;

                
                        var pie = d3.pie()
                            .value(function (d) { return floatFormat(d[variable]); })
                            .sort(null);



                        var arc = d3.arc()
                            .outerRadius(radius * 0.8)
                            .innerRadius(radius * 0.6)
                            .cornerRadius(cornerRadius)
                            .padAngle(padAngle);

                        var outerArc = d3.arc()
                            .outerRadius(radius * 0.9)
                            .innerRadius(radius * 0.9);


                    var wSvg = width + margin.left + margin.right, hSvg = height + margin.top + margin.bottom;
                    var svg = selection.append('svg')
                        .attr('width', wSvg)
                        .attr('height', hSvg)
                        .append('g')
                        .attr('transform', 'translate(' + wSvg / 2 + ',' + hSvg / 2 + ')');
                    // ===========================================================================================

                    svg.append('g').attr('class', 'slices');
                    svg.append('g').attr('class', 'labelName');
                    svg.append('g').attr('class', 'lines');

                    var path = svg.select('.slices')
                        .datum(data).selectAll('path')
                        .data(pie)
                        .enter().append('path')
                        .attr('fill', function (d) {
                            d.couleur = colour(d.data[category])
                            return d.couleur;
                        })
                        .attr('d', arc);

                    svg.append('text')
                        .html(title)
                        .attr('text-anchor', 'middle')
                        .attr('y', hSvg / 2);
                });

                // d3.csv("data.csv", function (error, data) {
                    //     if (error) {
                    //         throw error;
                    //     }

                    //     xScale.domain(data.map(function (d) { return d.year; }));
                    //     yScale.domain([0, d3.max(data, function (d) { return d.value; })]);

                    //     g.append("g")
                    //         .attr("transform", "translate(0," + height + ")")
                    //         .call(d3.axisBottom(xScale));

                    //     g.append("g")
                    //         .call(d3.axisLeft(yScale).tickFormat(function (d) {
                    //             return "$" + d;
                    //         }).ticks(10))
                    //         .append("text")
                    //         .attr("y", 6)
                    //         .attr("dy", "0.71em")
                    //         .attr("text-anchor", "end")
                    //         .text("value");
                    // })
            }

            chart.width = function (value) {
                if (!arguments.length) return width;
                width = value;
                return chart;
            };

            chart.height = function (value) {
                if (!arguments.length) return height;
                height = value;
                return chart;
            };

            chart.margin = function (value) {
                if (!arguments.length) return margin;
                margin = value;
                return chart;
            };

            chart.radius = function (value) {
                if (!arguments.length) return radius;
                radius = value;
                return chart;
            };

            chart.padAngle = function (value) {
                if (!arguments.length) return padAngle;
                padAngle = value;
                return chart;
            };

            chart.cornerRadius = function (value) {
                if (!arguments.length) return cornerRadius;
                cornerRadius = value;
                return chart;
            };

            chart.colour = function (value) {
                if (!arguments.length) return colour;
                colour = value;
                return chart;
            };

            chart.variable = function (value) {
                if (!arguments.length) return variable;
                variable = value;
                return chart;
            };

            chart.category = function (value) {
                if (!arguments.length) return category;
                category = value;
                return chart;
            };

            chart.title = function (value) {
                if (!arguments.length) return title;
                title = value;
                return chart;
            };

            return chart;

        }



    </script>

</body>

</html>
=======
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humanité numérique 2021-2022</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /*pour les initiales en majuscule*/
        .card-title:first-letter {
            text-transform: uppercase;
        }

        .title {
            font-size: 40px;
            display: initial;
        }

        img {
            width: 100%;
            height: 100%;
            max-width: 200px;
            max-height: 200px;
        }

        .container {
            display: flex;
        }
    </style>
</head>

<body>
    <title class="title">Humanité numérique 2021 - 2022</title>


    <div class="container">
        <div class="row" id="etuGraph">

        </div>
        <svg width="600" height="500"></svg>
    </div>

    <script>

        //
        var dataPhoto, dataForm, dataFacet = [], dataDoublons = {}
            , vals = {
                "Pas besoin": 1, "Besoin d'approfondissement": 5, "Besoin urgent": 10, "je ne connais pas du tout": 1, "je connais un peu": 5, "je vonnais bien": 10, "je suis expert(e)": 20
                , "Oui": 1, "Non": 1
                , "jamais": 1, "rarement": 2, "souvent": 5, "je suis accro": 10
                , "Dans quel parcours êtes vous inscris ?": "Parcours"
                , "Avez-vous un ordinateur personnel pour suivre les cours ?": "Ordinateur"
                , "Votre connexion internet personnelle est :": "Connexion"
                , "Votre compte GitHub": "Compte"
                , "Votre compte Diigo": "Compte"
                , "Votre compte Zotero": "Compte"
                , "Vos spécialités": "Spécialités"
                , "Vos spécialités": "Objectifs"
                , "Votre formation précédente": "Formation"
                , "Quelles sont besoins ?": "Besoins"
                , "Quelles sont vos compétences ?": "Compétences"
                , "Quelles outils utilisez vous ?": "Outils"
                , "Langages": "Langages"
                , "Langues": "Langues"
                , "CMS": "CMS"
                , "Quels réseaux sociaux": "Réseaux sociaux"
            }
            , selectEtu;


        //récupération des données des formulaires google
        //"FormulaireGEN19.csv";//
        let url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTM42Rbon532i3N3aW25ZpkoKtsMN-u6C7ycSj6A3DP2QCO89n3OMkseL--aI9a9s3ouwQJsVk6cOFw/pub?gid=513110937&single=true&output=csv';
        //let url = 'data.csv';            
        var q = d3.queue()
            .defer(d3.csv, url)
            .awaitAll(function (error, results) {
                if (error) throw error;
                setData(results);
            });

        var divTT = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);

        function setData(data) {

            dataForm = data[0];
            let dataEtu = [];

            dataForm.forEach(function (d, j) {
                d.reponses = { 'besoins': [], 'competences': [], 'outils': [] };
                for (let i in d) {

                    let quest = i.indexOf("[") > 0 ? vals[i.substring(0, i.indexOf("[") - 1)] : vals[i];
                    let prop = i.substring(i.indexOf("[") + 1, i.indexOf("]"));
                    let v = d[i];
                    let n = vals[v];
                    if (quest) {
                        if (dataDoublons[quest] === undefined) {
                            dataDoublons[quest] = dataFacet.length;
                            dataFacet.push({ 'label': quest, 'values': [] });
                        }
                        let rep = prop ? prop : v;
                        let kRep = quest + '_' + rep;
                        if (dataDoublons[kRep] === undefined) {
                            dataDoublons[kRep] = dataFacet[dataDoublons[quest]]['values'].length;
                            dataFacet[dataDoublons[quest]]['values'].push({
                                'prop': rep
                                , 'importance': 0
                                , 'expression': v
                                , 'ids': []
                            });
                        }
                        dataFacet[dataDoublons[quest]]['values'][dataDoublons[kRep]]['ids'].push(j);
                        dataFacet[dataDoublons[quest]]['values'][dataDoublons[kRep]]['importance'] += n ? n : 1;

                    }
                    if (i.indexOf("besoins") > 0) {
                        d.reponses.besoins.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                    if (i.indexOf("compétences") > 0) {
                        d.reponses.competences.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                    if (i.indexOf("outils utilisez") > 0) {
                        d.reponses.outils.push({ 'prop': prop, 'importance': n, 'expression': v, 'id': j });
                    }
                }
            });


            var cards = d3.select('#etuGraph').selectAll(".col-sm-4 mb-12").data(dataForm).enter()
                .append('div').attr('class', 'col-sm-4 mb-12').style('margin-bottom', '10px')
                .append("div").attr('class', 'card');
            cards.append("img")
                .attr('id', function (d, i) { return 'imgCard' + i })
                .attr('class', 'card-img-top')
                .attr('src', function (d) {
                    let url = new URL(d['Votre photo']);
                    let urlParam = new URLSearchParams(url.search);
                    let id = urlParam.get('id');
                    let urlTof = "https://drive.google.com/uc?id=" + id + "&export=download";
                    return urlTof;
                });


    
            var cardBody = cards.append('div').attr('class', 'card-body');
            cardBody.append('h4').attr('class', 'card-title')
                .text(function (d) {
                    return d['Votre prénom'].toLowerCase();
                });
            cardBody.append('h5').attr('class', 'card-title')
                .text(function (d) {
                    return d['Votre nom'].toLowerCase();
                });
            cardBody.append('h6').text(d => d['Dans quel parcours êtes vous inscris ?']);


            html = '<div class="container"><div class="row">';
            html += '<div id="etudNum__Col1" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '<div id="etudNum__Col2" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '<div id="etudNum__Col3" class="col-sm" style="padding-right:0px;padding-left:0px;"></div>';
            html += '</div></div>';
            cardBody.append('div').attr('class', 'card-text').attr('id', function (d, i) { return 'etudNum_' + i; })
                .html(function (d, i) { return html.replace(/__/gi, "_" + i + "_"); });
            cards.append('div').attr('class', 'card-footer')
                .append('small').attr('class', 'text-muted')
                .text(function (d, i) {

                    var size = 200;
                    drawGraphResponse("#etudNum_" + i + "_Col1", 'Besoins', d.reponses.besoins, size);
                    drawGraphResponse("#etudNum_" + i + "_Col2", 'Compétences', d.reponses.competences, size);
                    drawGraphResponse("#etudNum_" + i + "_Col3", 'Outils', d.reponses.outils, size);
                    return d['Votre mail'].toLowerCase();
                });

        }

        // function drawChart(size, data, title) {
        //     var w = size, h = size, radius = Math.min(w, h) / 2;
        //     var floatFormat = d3.format('.4r');
        //     var color = d3.scaleOrdinal(d3.schemeCategory20b);

        //     var arc = d3.arc().innerRadius(radius * 0.6).outerRadius(radius * 0.8);

        //     var pie = d3.pie().value(function (d) { return floatFormat(d['importance']) }).sort(null);
        
        //     }
        // }

        function drawGraphResponse(idE, titre, data, size) {

            let etuGraph = etuChart()
                .width(size)
                .height(size)
                .cornerRadius(0)
                .padAngle(0)
                .variable('importance')
                .category('prop')
                .title(titre);
            let s = d3.select(idE)
                .datum(data)
                .call(etuGraph);
            console.log(idE + " graph fait");
        }

        function etuChart() {
            var width,
                height,
                margin = { top: 0, right: 0, bottom: 10, left: 0 },
                colour = d3.scaleOrdinal(d3.schemeCategory20c),
                variable,
                category,
                padAngle,
                floatFormat = d3.format('.4r'),
                cornerRadius,
                percentFormat = d3.format(',.2%'),
                title;

            function chart(selection) {
                selection.each(function (data) {


                    // var radius = Math.min(width, height) / 2;

                    // // var pie = d3.pie().value(function (d) {
                    // //     return floatFormat(d[variable]);
                    // // })
                    // //     .sort(null);

                    // var pie = d3.pie();

                    // var arc = d3.arc()
                    //     .innerRadius(0)
                    //     .outerRadius(radius);

                    // var arcs = g.selectAll("arc")
                    //     .data(pie(data))
                    //     .enter()
                    //     .append("g")
                    //     .attr("class", "arc")

                    // var arc = d3.arc()
                    //     .outerRadius(radius)
                    //     .innerRadius(radius)
                    //     .cornerRadius(cornerRadius)
                    //     .padAngle(padAngle);

                    // this arc is used for aligning the text labels
                    // var outerArc = d3.arc()
                    //     .outerRadius(radius)
                    //     .innerRadius(radius);

                    var radius = Math.min(width, height) / 2;

                
                        var pie = d3.pie()
                            .value(function (d) { return floatFormat(d[variable]); })
                            .sort(null);

                        var arc = d3.arc()
                            .outerRadius(radius * 0.8)
                            .innerRadius(radius * 0.6)
                            .cornerRadius(cornerRadius)
                            .padAngle(padAngle);

                        var outerArc = d3.arc()
                            .outerRadius(radius * 0.9)
                            .innerRadius(radius * 0.9);


                    var wSvg = width + margin.left + margin.right, hSvg = height + margin.top + margin.bottom;
                    var svg = selection.append('svg')
                        .attr('width', wSvg)
                        .attr('height', hSvg)
                        .append('g')
                        .attr('transform', 'translate(' + wSvg / 2 + ',' + hSvg / 2 + ')');
                    // ===========================================================================================

                    svg.append('g').attr('class', 'slices');
                    svg.append('g').attr('class', 'labelName');
                    svg.append('g').attr('class', 'lines');

                    var path = svg.select('.slices')
                        .datum(data).selectAll('path')
                        .data(pie)
                        .enter().append('path')
                        .attr('fill', function (d) {
                            d.couleur = colour(d.data[category])
                            return d.couleur;
                        })
                        .attr('d', arc);

                    svg.append('text')
                        .html(title)
                        .attr('text-anchor', 'middle')
                        .attr('y', hSvg / 2);
                });

                // d3.csv("data.csv", function (error, data) {
                    //     if (error) {
                    //         throw error;
                    //     }

                    //     xScale.domain(data.map(function (d) { return d.year; }));
                    //     yScale.domain([0, d3.max(data, function (d) { return d.value; })]);

                    //     g.append("g")
                    //         .attr("transform", "translate(0," + height + ")")
                    //         .call(d3.axisBottom(xScale));

                    //     g.append("g")
                    //         .call(d3.axisLeft(yScale).tickFormat(function (d) {
                    //             return "$" + d;
                    //         }).ticks(10))
                    //         .append("text")
                    //         .attr("y", 6)
                    //         .attr("dy", "0.71em")
                    //         .attr("text-anchor", "end")
                    //         .text("value");
                    // })
            }

            chart.width = function (value) {
                if (!arguments.length) return width;
                width = value;
                return chart;
            };

            chart.height = function (value) {
                if (!arguments.length) return height;
                height = value;
                return chart;
            };

            chart.margin = function (value) {
                if (!arguments.length) return margin;
                margin = value;
                return chart;
            };

            chart.radius = function (value) {
                if (!arguments.length) return radius;
                radius = value;
                return chart;
            };

            chart.padAngle = function (value) {
                if (!arguments.length) return padAngle;
                padAngle = value;
                return chart;
            };

            chart.cornerRadius = function (value) {
                if (!arguments.length) return cornerRadius;
                cornerRadius = value;
                return chart;
            };

            chart.colour = function (value) {
                if (!arguments.length) return colour;
                colour = value;
                return chart;
            };

            chart.variable = function (value) {
                if (!arguments.length) return variable;
                variable = value;
                return chart;
            };

            chart.category = function (value) {
                if (!arguments.length) return category;
                category = value;
                return chart;
            };

            chart.title = function (value) {
                if (!arguments.length) return title;
                title = value;
                return chart;
            };

            return chart;

        }



    </script>


</body>

</html>
>>>>>>> 6f04c330762ec877e499b776a0eb8eb6d447fabb
=======
=======
>>>>>>> e5aabc5ca36e17037a3e6f9e39730bc28eaabb59
    <title>Mention Humanités Numériques 2021 - 2022</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="./css/styles.css" />
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
</head>

<body>
    <title>Mention Humanités Numériques 2021 - 2022</title>

    <input id="searchbar" onkeyup="searchEtud()" type="text" name="search" placeholder="Rechercher un étudiant">

    <div class="find"></div>

    <div class="container" style="margin-top: 10px;">
        <div class="row" id="rows">
            <div id="myGraph"></div>
        </div>
    </div>

    <script type="text/javascript">

        // function searchEtud() {
        //     let f = document.getElementsByClassName("find")
        //     let r = document.getElementById("rows")

        //     let input = document.getElementById('searchbar').value
        //     input = input.toLowerCase();
        //     let x = document.getElementsByClassName('name');

        //     for (i = 0; i < x.length; i++) {
        //         if (!x[i].innerHTML.toLowerCase().includes(input)) {
        //             x[i].style.display = "none";
        //         } else {
        //             f.innerHTML += "<div>"+ x[i] + "</div>"
        //         }
        //     }
        // }

        // let url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTM42Rbon532i3N3aW25ZpkoKtsMN-u6C7ycSj6A3DP2QCO89n3OMkseL--aI9a9s3ouwQJsVk6cOFw/pub?gid=1340290303&single=true&output=csv";
        let container_row = document.getElementById("rows");
        // var div = d3.select("body").append("div")
        //     .attr("class", "tooltip-donut")
        //     .style("opacity", 0);

        // d3.queue().defer(d3.csv, url).awaitAll(function (error, results) {
        //     if (error) throw error;
        //     setData(results);
        // });

        d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vTM42Rbon532i3N3aW25ZpkoKtsMN-u6C7ycSj6A3DP2QCO89n3OMkseL--aI9a9s3ouwQJsVk6cOFw/pub?gid=1340290303&single=true&output=csv").then(function (data) {
            setData(data);
            // console.log(data);
        });

        function setData(data) {

            for (let i = 0; i < data.length; i++) {
                let CMS = []
                let langages = []
                let langues = []
                let outils = []
                let skills = []
                let social = []
                let besoins = []
                // console.log(data[i])
                var keys = Object.keys(data[i])
                keys.forEach((r) => {
                    // console.log(keys[i])
                    if (r.includes("CMS")) {
                        CMS.push(data[i][r]);
                    }
                    if (r.includes("Langages")) {
                        langages.push(data[i][r]);
                    }
                    if (r.includes("Langues")) {
                        langues.push(data[i][r]);
                    }
                    if (r.includes("outils")) {
                        outils.push(data[i][r]);
                    }
                    if (r.includes("compétences")) {
                        skills.push(data[i][r]);
                    }
                    if (r.includes("sociaux")) {
                        social.push(data[i][r]);
                    }
                    if (r.includes("besoins")) {
                        besoins.push(data[i][r]);
                    }
                })

                let url = new URL(data[i]['Votre photo']);
                let urlParam = new URLSearchParams(url.search);
                let id = urlParam.get('id');
                let urlTof = "https://drive.google.com/uc?id=" + id + "&export=download";
                container_row.innerHTML += "<div class='profil' onclick='showGraph()'>"
                    + "<div class='image'><img src=" + urlTof + "></div>"
                    // + "<img class='profil-img' src=" + url + ">"
                    + "<p class='name'>Nom et prénom : " + data[i]["Votre nom"] + " " + data[i]["Votre prénom"] + "<span><br> Numéro étudiant : " + data[i]["N° étudiant"] + "</span></p> "
                    + "<p class='email'>Email : <a href='mailto:" + data[i]["Votre mail"] + "'>" + data[i]["Votre mail"] + "</a></p> "
                    + "<p class='formation'>Parcours : " + data[i]["Dans quel parcours êtes vous inscris ?"] + "</p> "
                    + "<p class='skills'>Compétences : " + data[i]["Vos spécialités"] + "</p>"
                    + "<p class='github'>GitHub : <a target='_blank' href='https://github.com/" + data[i]["Votre compte GitHub"] + "'> " + data[i]["Votre compte GitHub"] + "</a></p>"
                    + "<p class='diigo'>Diigo : <a target='_blank' href='https://www.diigo.com/user/" + data[i]["Votre compte Diigo"] + "'> " + data[i]["Votre compte Diigo"] + "</a></p>"
                    // + "<p class='zotero'>Zotero : <a target='_blank' href='https://www.zotero/..." + data[i]["Votre compte Zotero"] + "'> " + data[i]["Votre compte Zotero"] + "</a></p>"
                    + "<button onclick='showGraph(" + JSON.stringify(skills) +")'>Graphique</button>"
                    + "</div>";

            }


            // console.log('CMS :', CMS);
            // console.log('Langages : ', langages);
            // console.log('Langues : ', langages);
            // console.log('outils : ', outils);
            // console.log('skills : ', skills);
            // console.log('sociaux : ', social);
            // console.log('besoins : ', besoins);
        }

        function showGraph(p) {
            console.log('Response : ', p);

            // drawGraph();
        }

        // function drawGraph() {
        //     // set the dimensions and margins of the graph
        //     var margin = { top: 10, right: 30, bottom: 30, left: 40 },
        //         width = 460 - margin.left - margin.right,
        //         height = 400 - margin.top - margin.bottom;

        //     // append the svg object to the body of the page
        //     var svg = d3.select("#my_dataviz")
        //         .append("svg")
        //         .attr("width", width + margin.left + margin.right)
        //         .attr("height", height + margin.top + margin.bottom)
        //         .append("g")
        //         .attr("transform",
        //             "translate(" + margin.left + "," + margin.top + ")");

        //     // get the data


        //     // X axis: scale and draw:
        //     var x = d3.scaleLinear()
        //         .domain([0, 1000])  
        //         .range([0, width]);
        //     svg.append("g")
        //         .attr("transform", "translate(0," + height + ")")
        //         .call(d3.axisBottom(x));

        //     // set the parameters for the histogram
        //     var histogram = d3.histogram()
        //         .value(function (d) { return d.price; })   // I need to give the vector of value
        //         .domain(x.domain())  // then the domain of the graphic
        //         .thresholds(x.ticks(70)); // then the numbers of bins

        //     // And apply this function to data to get the bins
        //     var bins = histogram(data);

        //     // Y axis: scale and draw:
        //     var y = d3.scaleLinear()
        //         .range([height, 0]);
        //     y.domain([0, d3.max(bins, function (d) { return d.length; })]);   // d3.hist has to be called before the Y axis obviously
        //     svg.append("g")
        //         .call(d3.axisLeft(y));

        //     // append the bar rectangles to the svg element
        //     svg.selectAll("rect")
        //         .data(bins)
        //         .enter()
        //         .append("rect")
        //         .attr("x", 1)
        //         .attr("transform", function (d) { return "translate(" + x(d.x0) + "," + y(d.length) + ")"; })
        //         .attr("width", function (d) { return x(d.x1) - x(d.x0) - 1; })
        //         .attr("height", function (d) { return height - y(d.length); })
        //         .style("fill", "#69b3a2")
        // }
    </script>
</body>


</html>
<<<<<<< HEAD
>>>>>>> 7bab28d0387413d6fe6b8475e3b8ac31592c1c7c
=======
>>>>>>> e5aabc5ca36e17037a3e6f9e39730bc28eaabb59
